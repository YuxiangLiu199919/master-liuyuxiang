<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.etc.springcloud.mapper.GoodsMapper">
<!--查询所有商品-->
    <select id="queryGoods" resultType="Goods">
        select * from goods where stock>0
    </select>
    <!--查询所有商品-->
    <select id="queryGoodsByName" resultType="Goods">
        select * from goods
        <where>

            <if test="name!=null and name!=''">
                name like concat("%",#{name},"%")
            </if>
                and stock>0
        </where>
    </select>

<!--查询特价商品-->
    <select id="querySpecialGoods" resultType="Goods">
        select G.*,T.type_name as typeName from goods G,type T
        where G.type_id=T.tid and T.type_name='特价商品' and G.stock>0
    </select>
<!--根据id查询Goods-->
    <select id="getGoodsById" resultType="Goods">
        select * from goods where gid=#{gid}
    </select>

    <!--根据TypeId查询Goods-->
    <select id="queryGoodsByTypeId" resultType="Goods">
        select * from goods where type_id=#{tid} and stock>0
    </select>

<!--  根据商品id更新商品库存量  -->
    <update id="upGoodsStocks">
        update goods set stock=(goods.stock)-#{num} where gid=#{gid}
        and (goods.stock)-#{num}>=0;
    </update>


</mapper>